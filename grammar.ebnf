(* CompText Domain-Specific Language - Formal Grammar *)
(* EBNF Specification v1.0 *)

(* ==================== TOP-LEVEL STRUCTURE ==================== *)

program          = { statement };

statement        = command
                 | module_import
                 | variable_assignment
                 | comment;

(* ==================== COMMANDS ==================== *)

command          = identifier, [ parameters ], [ options ];

identifier       = letter, { letter | digit | "-" | "_" };

parameters       = "(", [ param_list ], ")";

param_list       = param, { ",", param };

param            = key_value_pair | positional_value;

key_value_pair   = identifier, "=", value;

positional_value = value;

(* ==================== VALUES ==================== *)

value            = string
                 | number
                 | boolean
                 | array
                 | object
                 | reference;

string           = '"', { string_char }, '"'
                 | "'", { string_char }, "'";

string_char      = ? any character except quote ?
                 | escape_sequence;

escape_sequence  = "\", ( "\"" | "\'" | "\n" | "\t" | "\r" );

number           = [ "-" ], digit, { digit }, [ ".", digit, { digit } ];

boolean          = "true" | "false";

array            = "[", [ value_list ], "]";

value_list       = value, { ",", value };

object           = "{", [ key_value_list ], "}";

key_value_list   = key_value_pair, { ",", key_value_pair };

reference        = "$", identifier;

(* ==================== OPTIONS ==================== *)

options          = "--", option_list;

option_list      = option, { " ", option };

option           = flag_option | value_option;

flag_option      = identifier;

value_option     = identifier, "=", value;

(* ==================== MODULES ==================== *)

module_import    = "import", string, [ "as", identifier ];

(* ==================== VARIABLES ==================== *)

variable_assignment = identifier, ":=", value;

(* ==================== COMMENTS ==================== *)

comment          = line_comment | block_comment;

line_comment     = "#", { ? any character except newline ? };

block_comment    = "/*", { ? any character ? }, "*/";

(* ==================== BASIC TOKENS ==================== *)

letter           = "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J"
                 | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T"
                 | "U" | "V" | "W" | "X" | "Y" | "Z"
                 | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j"
                 | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t"
                 | "u" | "v" | "w" | "x" | "y" | "z";

digit            = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9";

(* ==================== END OF GRAMMAR ==================== *)
